# ユーザー検索修正完了

## 問題
チャンネル内でユーザーを指定して検索すると、実際よりも少ないメッセージしか取得されない（42件中7件のみ）

## 原因
1. `search_messages`関数で、テキストクエリがない場合の条件判定が間違っていた
   - 修正前: `if query.trim().is_empty() && !is_multi_user`（マルチユーザーでない場合のみ）
   - 修正後: `if query.trim().is_empty()`（ユーザーフィルターの有無に関わらず）

2. conversations.history APIを使用した後、ユーザーフィルタリングが実装されていなかった

3. ユーザーフィルタリング時に取得するメッセージ数が不足していた（デフォルト100件では少ない）

## 実施した修正

### 1. search.rs - 条件判定の修正（246行目）
```rust
// 修正前
if query.trim().is_empty() && !is_multi_user {

// 修正後
if query.trim().is_empty() {
```

### 2. search.rs - ユーザーフィルタリングの追加（314-376行目）
conversations.history APIでメッセージ取得後、ユーザーIDでフィルタリングする処理を追加

### 3. search.rs - 取得メッセージ数の増加（300-306行目）
ユーザーフィルタリング時は最大1000件まで取得するように変更（フィルタリング後に指定の上限数に制限）

### 4. client.rs - デバッグログの追加
APIコールの詳細なログを追加して、取得されるメッセージとタイムスタンプの範囲を確認できるようにした

## 動作確認
アプリケーションを再起動して、ユーザー指定検索を実行すると、正しい件数のメッセージが取得されるようになりました。

## 技術詳細
- Slack conversations.history APIはページネーション対応済み（最大10回のAPIコール）
- 1回のAPIコールで最大200件取得（Slack推奨値）
- ユーザーフィルタリング時は初期取得数を増やして、フィルター後の件数を確保